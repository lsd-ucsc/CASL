# Distributed Software Systems: Global-First and Local-First Perspectives

## Part I: Global First!

[Multitier programming](https://en.wikipedia.org/wiki/Multitier_programming) and [choreographic programming](https://en.wikipedia.org/wiki/Choreographic_programming) are distributed programming paradigms in which a single program expresses the behavior of multiple participants.  Multitier programming has existed in some form or another since the early 2000s (and its roots go back further than that), but much of the work in this space, such as the [Pirouette](https://dl.acm.org/doi/abs/10.1145/3498684) language, is quite new.  We call this approach "global-first" because in multitier and choreographic programming, one begins by considering the behavior of an entire system.  While various approaches to distributed programming purport to ["let you think about your application as a single program that happens to run on multiple machines, rather than a collection of programs running on different machines that talk to one another"](https://www.oreilly.com/library/view/parallel-and-concurrent/9781449335939/ch14.html), and hence simplify matters, global-first programming takes this point of view to the extreme: in global-first programming, you have *no choice* but to think of your application as a single nprogram.

In this part of the course, we will study the multitier and choreographic programming research literature and consider the strengths and weaknesses of a global-first approach.  For example, a strength of choreographic programming is ["deadlock-freedom-by-design"](https://dl.acm.org/doi/10.1145/2480359.2429101): because communication between participants can only be expressed by a single language construct (which compiles to a message *send* on one participant and a *receive* on another), it is impossible for the resulting collection of programs to contain a mismatched send and receive.  On the other hand, much work on choreographic programmins assumes that communication must be instantaneous, synchronous, and lossless.  Can the promise of deadlock-freedom-by-design actually be realized on an asynchronous Internet where ["everything fails all the time"](https://cacm.acm.org/magazines/2020/2/242334-everything-fails-all-the-time/fulltext)?  Furthermore, does a global-first approach make sense for applications where we may not know in advance how all participants in an execution will behave or how they should interact?

### Overview and motivation

1. [Pascal Weisenburger et al., "A Survey of Multitier Programming" (ACM Computing Surveys, 2020)](https://dl.acm.org/doi/abs/10.1145/3397495) (recent survey; mentions HipHop, Ur/Web, Links, Hop, etc.)

2. [Saverio Giallorenzo et al., "Multiparty Languages: The Choreographic and Multitier Cases (Pearl)" (ECOOP 2021)](https://drops.dagstuhl.de/opus/volltexte/2021/14065/) (a new-ish paper that attempts to bridge choreographic and multitier programming, using ScalaLoci and Choral, respectively, as representative of the two approaches)

### Multitier programming

3. [Ezra Cooper et al., "Links: web programming without tiers" (FMCO 2006)](https://link.springer.com/chapter/10.1007/978-3-540-74792-5_12) (see also the [Links website](https://links-lang.org/), with links (heh) to many follow-on works)
 
4. [Manuel Serrano, "Hop, a Language for Programming the Web 2.0" (DLS 2006)](https://www.lri.fr/~conchon/TER/2012/3/dls06.pdf) (can't find an authoritative link; see also the [ACM Queue article](https://dl.acm.org/doi/10.1145/2330087.2330089))
 
5. [Adam Chlipala, "Ur/Web: A Simple Model for Programming the Web" (POPL 2015)](https://dl.acm.org/doi/abs/10.1145/2676726.2677004) (see also the [Ur/Web website](http://www.impredicative.com/ur/))
 
6. [Pascal Weisenburger et al., "Distributed system development with ScalaLoci" (OOPSLA 2018)](https://dl.acm.org/doi/10.1145/3276499) (see also the [ScalaLoci website](https://scala-loci.github.io/))

### Choreographic programming

7. [Marco Carbone and Fabrizio Montesi, "Deadlock-freedom-by-design: multiparty asynchronous global programming" (POPL 2013)](https://dl.acm.org/doi/10.1145/2480359.2429101) see also [Montesi's Ph.D. dissertation, "Choreographic Programming"](https://www.fabriziomontesi.com/files/choreographic_programming.pdf); chapter 2 of the dissertation is based on this paper
 
8. [Luís Cruz-Filipe and Fabrizio Montesi, "On Asynchrony and Choreographies" (ICE 2017)](https://arxiv.org/abs/1711.11211)
 
9. [Saverio Giallorenzo et al., "Object-Oriented Choreographic Programming" (2022)](https://arxiv.org/abs/2005.09520) (description of the Choral programming language; see also the [Choral website](https://www.choral-lang.org/))
 
10. [Andrew K. Hirsch and Deepak Garg, "Pirouette: higher-order typed functional choreographies" (POPL 2022)](https://dl.acm.org/doi/abs/10.1145/3498684)

## Part II: Local First!

In seeming contrast to multitier and choreographic programming is the notion of ["local-first"](https://www.inkandswitch.com/local-first/) software, in which network connections are expected to be intermittent, different participants may be running different versions of an application, and individuals operate autonomously with a minimum of centralization and coordination.  The local-first ethos also emphasizes user agency, privacy, security, and long-term preservation of data, and we hope to honor these principles in our study of local-first software -- while resisting techno-utopianism and longtermism.

In this course, we will aim at developing an understanding of what "local first" means in terms of technical requirements, especially from a languages and systems perspective.  Local-first software should work when a network connection is absent or intermittent, and after reconnecting, there should be a way to resolve Alice's edits against the edits made by Bob and Carol while Alice was offline.  Network storage and peer-to-peer connectivity may be necessary.  [Conflict-free replicated data types](https://dl.acm.org/doi/10.5555/2050613.2050642) -- data structures designed for replication across multiple participants in a setting where coordination may be infrequent -- have been [proposed](https://www.inkandswitch.com/local-first/) as a foundational technology for local-first software, and have seen much attention in the programming languages and verification research world in the last ten years.  [Content-addressable storage](https://dl.acm.org/doi/10.1145/383059.383072) will also be a topic of discussion: it is particularly well suited to decentralized systems, in which the contents of the data to be retrieved are more important than its current physical location.

At the end of the course, we'll attempt to [synthesize](https://en.wikipedia.org/wiki/Dialectic#Hegelian_dialectic) what we've learned from studying global-first and local-first distributed software systems into a coherent whole.  Perhaps these paradigms need not be at odds with each other.  Can we write local-first software in a global-first paradigm?

### Overview and motivation

11. [Martin Kleppmann et al., "Local-first software: you own your data, in spite of the cloud" (Onward! 2019)](https://dl.acm.org/doi/10.1145/3359591.3359737) (an essay introducing the term "local-first")

### CRDTs and friends

12. [Marc Shapiro et al., "Conflict-free replicated data types" (SSS 2011)](https://dl.acm.org/doi/10.5555/2050613.2050642) (the original paper on CRDTs)
 
13. [C. A. Ellis and S. J. Gibbs, "Concurrency control in groupware systems" (SIGMOD 1989)](https://dl.acm.org/doi/10.1145/66926.66963) (the original Operational Tranformation algorithm, an alternative to (and forerunner of) CRDTs for collaborative editing applications; see also Abhishek Singh's blog posts explaining this paper ([part 1](https://decomposition.al/CMPS290S-2018-09/2018/11/20/conflict-resolution-in-collaborative-text-editing-with-operational-transformation-part-1-of-2.html); [part 2](https://decomposition.al/CMPS290S-2018-09/2018/12/13/conflict-resolution-in-collaborative-text-editing-with-operational-transformation-part-2-of-2.html)))
 
14. [Gowtham Kaki et al., "Mergeable replicated data types" (PLDI 2019)](https://dl.acm.org/doi/10.1145/3360580) (A recent paper proposing an alternative to traditional CRDTs)
 
15. [Nicholas Schiefer et al., "Merge What You Can, Fork What You Can’t: Managing Data Integrity in Local-First Software" (PaPoC 2022)](https://riffle.systems/papoc22.pdf) (from the [Riffle](https://riffle.systems/) people, another alternative to traditional CRDTs)

### Digital preservation

16. [Petros Maniatis et al., "The LOCKSS peer-to-peer digital preservation system" (ToCS 2005)](https://dl.acm.org/doi/abs/10.1145/1047915.1047917) ("Lots Of Copies Keep Stuff Safe"; relates to the digital-preservation aspect of the local-first movement)
 
17. [Danielle C. Robinson et al., "The Dat Project, an open and decentralized research data tool" (Scientific Data, 2018)](https://www.nature.com/articles/sdata2018221)
  
### Content-addressability, DHTs, and all that

18. [Sylvia Ratnasamy et al., "A scalable content-addressable network" (SIGCOMM 2001)](https://dl.acm.org/doi/10.1145/383059.383072) (The paper that introduced the term "content-addressable")

19. [Erik Daniel and Florian Tschorsch, "IPFS and Friends: A Qualitative Comparison of Next Generation Peer-to-Peer Data Networks" (IEEE Communications Surveys & Tutorials, 2022)](https://ieeexplore.ieee.org/abstract/document/9684521) (looks like a high-quality survey paper covering IPFS, Swarm, Hypercore (Dat), SAFE, Storj, and Arweave, and contextualizing them with respect to previous work)

20. [Ion Stoica et al., "Chord: A Scalable Peer-to-peer Lookup Service for Internet
Applications" (SIGCOMM '01)](https://dl.acm.org/doi/10.1145/964723.383071) (an early, influential paper on DHTs)

21. [Pamela Zave, "Using Lightweight Modeling to Understand Chord" (SIGCOMM Computer Communications Review, 2012)](https://dl.acm.org/doi/10.1145/2185376.2185383) (using Alloy to find bugs in Chord; a complement to the Chord paper)
 
22. [Petar Maymounkov and David Mazières, "Kademlia: A Peer-to-Peer Information System Based on the XOR Metric" (IPTPS 2002)](https://dl.acm.org/doi/10.5555/646334.687801) (a follow-up to Chord)
  
### Further reading

 - [Antony Rowstron and Peter Druschel, "Pastry: Scalable, Decentralized Object Location, and Routing for Large-Scale Peer-to-Peer Systems" (Middleware 2001)](https://link.springer.com/chapter/10.1007/3-540-45518-3_18) (another early, influential paper on DHTs)
 
 - [Miguel Castro et al., "Scribe: a large-scale and decentralized application-level multicast infrastructure" (JSAC 2002)](https://ieeexplore.ieee.org/abstract/document/1038579) (an influential multicast system built on top of Pastry)
 
 - [Victor B. F. Gomes et al., "Verifying strong eventual consistency in distributed systems" (OOPSLA 2017)](https://dl.acm.org/doi/10.1145/3133933) (perhaps my favorite CRDT verification paper because of the high quality of the writing)
 
#### Some primary sources that might be worth a look

 - ["IPFS - Content Addressed, Versioned, P2P File System"](https://arxiv.org/abs/1407.3561)

 - ["Dat - Distributed Dataset Synchronization And Versioning" (2017)](https://osf.io/nsv2c/)
 
#### More stuff

 - cjdns https://github.com/cjdelisle/cjdns/blob/master/doc/Whitepaper.md (?)
 
 - Something about Yggdrasil??
 
 - Something about Datalog / Bloom / CALM / the Fission Dialog thingie ?
 
### Acknowledgments

Thanks to Andrew Hirsch, Martin Kleppmann, and Patrick Redmond for their feedback and assistance with creating this reading list.
